<app-layout>

  <main class="home" [class.no-auth]="!auth.hasValidSession()">


    <ng-container *ngIf="auth.hasValidSession(); else noAuth">
      <div class="page-container">
      <h1>Bienvenido a ShowMeShows</h1>


      <div class="carousel" *ngIf="series.length > 0">
        <div class="slides-wrapper">
          <div class="slide" *ngFor="let serie of series | slice:0:3; let i = index"
            [class.active]="i === currentSlide">
            <img class="hero-bg" [src]="'https://image.tmdb.org/t/p/original' + serie.backdrop_path"
              alt="{{ serie.name }}">
            <div class="hero-info" *ngIf="i === currentSlide">
              <h2>{{ serie.name }}</h2>
              <p>{{ serie.overview }}</p>
              <button [routerLink]="['/serie', serie.id]" class="btn-primary">Ver detalles</button>
            </div>
          </div>
        </div>

      </div>

      <!-- ================================
          SECCIONES PARA USUARIO LOGUEADO
          ================================ -->


      <section class="home-section">
        <div class="section-header">
          <h2>ğŸ“ˆ En Tendencia</h2>
        </div>

        <div class="scroll-wrapper">
          <button class="btn-arrow left" (click)="scrollLeft()" title="Anterior">
            <svg viewBox="0 0 24 24" class="icon">
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
          </button>
          <div class="scroll-row" #scrollContainer>
            <div class="serie-card" *ngFor="let t of tendencias">
              <div class="serie-img-container">
                <img [src]="'https://image.tmdb.org/t/p/w300' + t.poster_path" [alt]="t.name" />
              </div>
              <div class="serie-info">
                <h3 class="serie-title">{{ t.name }}</h3>
                <div class="serie-meta">
                  <span class="serie-year" *ngIf="t.first_air_date">{{ t.first_air_date | date:'yyyy' }}</span>
                  <span class="serie-rating">â­ {{ t.vote_average | number:'1.1-1' }}</span>
                </div>
              </div>
            </div>
          </div>
          <button class="btn-arrow right" (click)="scrollRight()" title="Siguiente">
            <svg viewBox="0 0 24 24" class="icon">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
        </div>
      </section>



      <!-- â­ POPULAR EN SHOWMESHOWS -->
      <section class="home-section">
        <div class="section-header">
          <h2>ğŸ”¥ Popular en ShowMeShows</h2>
        </div>

        <div class="scroll-row">
          <div class="scroll-card" *ngFor="let p of [1,2,3,4,5]">
            <div class="placeholder-img"></div>
            <h4 class="placeholder-title">Serie popular</h4>
          </div>
        </div>
      </section>


      <!-- â­ DESCUBRIR SERIES -->
      <section class="home-section">
        <div class="section-header">
          <h2>ğŸ§­ Descubrir nuevas series</h2>
          <button routerLink="/descubrir" class="ver-mas-btn">Ver mÃ¡s</button>
        </div>

        <div class="scroll-row">
          <div class="scroll-card" *ngFor="let d of [1,2,3,4]">
            <div class="placeholder-img"></div>
            <h4 class="placeholder-title">Nueva serie</h4>
          </div>
        </div>
      </section>


      <!-- â­ ÃšLTIMAS RESEÃ‘AS -->
      <section class="home-section">
        <div class="section-header">
          <h2>ğŸ“ Ãšltimas reseÃ±as</h2>
        </div>

        <div class="reviews-row">
          <div class="review-card" *ngFor="let r of [1,2,3]">
            <div class="review-user">
              <div class="avatar"></div>
              <span class="username">UsuarioX</span>
            </div>

            <p class="review-text">"ReseÃ±a de ejemplo para mostrar cÃ³mo quedarÃ¡ la secciÃ³n visualmente."</p>

            <span class="review-serie">Serie comentada</span>
          </div>
        </div>
      </section>


      <!-- â­ USUARIO CON MÃS RESEÃ‘AS -->
      <section class="home-section">
        <div class="section-header">
          <h2>ğŸ† Usuario con mÃ¡s reseÃ±as</h2>
        </div>

        <div class="top-user-card">
          <div class="avatar big"></div>

          <div class="top-user-info">
            <h3>Nombre del usuario</h3>
            <p>250 reseÃ±as publicadas</p>
          </div>
        </div>
      </section>


      <!-- â­ LISTAS PÃšBLICAS CON MÃS LIKES -->
      <section class="home-section">
        <div class="section-header">
          <h2>ğŸ“š Listas pÃºblicas con mÃ¡s likes</h2>
          <button routerLink="/listas-publicas" class="ver-mas-btn">Ver mÃ¡s</button>
        </div>

        <div class="listas-grid-home">
          <div class="lista-publica-card" *ngFor="let l of [1,2,3,4]">
            <h4>Nombre de la lista</h4>
            <p class="likes">â¤ï¸ 120 likes</p>
          </div>
        </div>
      </section>


</div>

      <!-- <div class="series-list">
        <div *ngFor="let serie of series" class="serie-card" [routerLink]="['/serie', serie.id]">
          <img [src]="'https://image.tmdb.org/t/p/w300' + serie.poster_path" alt="{{ serie.name }}">

          <div class="serie-info">
            <h3 class="serie-title">{{ serie.name }}</h3>

            <div class="serie-meta">
              <span class="serie-year">{{ serie.first_air_date | date:'yyyy' }}</span>

              <div class="serie-rating">
                <span class="stars">â­</span>
                <span class="rating-number">{{ serie.vote_average | number:'1.1-1' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div> -->

      <!-- <div *ngIf="loading" class="loading">
        <p>Cargando mÃ¡s series...</p>
      </div> -->
    </ng-container>

    <ng-template #noAuth>
      <div class="welcome-logo">
        <img src="recursos/Logo.png" alt="ShowMeShows Logo">
      </div>
      <section class="welcome-container">

        <div class="hero">
          <h2>Descubre, sigue y comparte tus series favoritas</h2>
          <p>Explora miles de series, guarda tu progreso y conecta con otros fans.</p>

          <div class="cta-buttons">
            <button routerLink="/registro" class="btn-primary">Crear cuenta</button>
            <button routerLink="/login" class="btn-secondary">Iniciar sesiÃ³n</button>
          </div>
        </div>

        <div class="features">
          <div class="feature">
            <i class="icon">ğŸ“º</i>
            <h3>Explora series</h3>
            <p>InformaciÃ³n actualizada, trÃ¡ilers y recomendaciones.</p>
          </div>

          <div class="feature">
            <i class="icon">â­</i>
            <h3>Guarda tu progreso</h3>
            <p>Lleva un registro de episodios y temporadas vistas.</p>
          </div>

          <div class="feature">
            <i class="icon">ğŸ’¬</i>
            <h3>Comparte opiniones</h3>
            <p>Publica reseÃ±as y descubre lo que opina la comunidad.</p>
          </div>

          <div class="feature">
            <i class="icon">ğŸ§­</i>
            <h3>Crea listas</h3>
            <p>Organiza tus series favoritas con listas personalizadas.</p>
          </div>
        </div>

        <div class="popular-preview">
          <h3>Lo mÃ¡s visto esta semana</h3>
          <div class="preview-grid">
            <div *ngFor="let serie of series" class="preview-card">
              <img [src]="'https://image.tmdb.org/t/p/w300' + serie.poster_path">
            </div>
          </div>
        </div>

        <!-- <div class="final-cta">
          <p>Ãšnete gratis y empieza a descubrir tu prÃ³xima serie favorita</p>
          <button routerLink="/register" class="btn-primary">Comenzar</button>
        </div> -->

      </section>
    </ng-template>
  </main>

</app-layout>