<app-layout>

  <!-- Información de la serie -->
  <main *ngIf="serie" class="serie-info text-white">
    <div class="serie-background"
      [style.background-image]="'url(https://image.tmdb.org/t/p/original' + serie.backdrop_path + ')'"></div>
    <div class="overlay-gradient"></div>

    <div class="serie-content">
      <!-- Imagen -->
      <div class="poster-container">
        <img [src]="'https://image.tmdb.org/t/p/w500' + serie.poster_path" alt="{{ serie.name }}"
          class="poster rounded-4 shadow-lg" />
      </div>

      <!-- Información -->
      <div class="info-container">
        <h1 class="fw-bold text-primary mb-3">{{ serie.name }}</h1>
        <p class="lead text-light mb-4">
          <strong>Sinopsis:</strong> {{ serie.overview }}
        </p>

        <p><strong>Fecha de estreno:</strong> {{ serie.first_air_date }}</p>
        <p><strong>Puntuación:</strong> <span class="text-warning">{{ serie.vote_average }} ⭐</span></p>

        <div class="mt-4 d-flex gap-3 flex-wrap" *ngIf="auth.hasValidSession()">
          <button class="btn btn-outline-light">
            <i class="bi bi-play-circle"></i> Ver Tráiler
          </button>
          <button class="btn" [class.btn-warning]="!isFavorite" [class.btn-danger]="isFavorite"
            (click)="toggleFavorite()">
            <i class="bi" [ngClass]="isFavorite ? 'bi-star-fill' : 'bi-star'"></i>
            {{ isFavorite ? 'Quitar de Favoritos' : 'Agregar a Favoritos' }}
          </button>
          <button class="btn btn-warning text-dark" (click)="toggleListMenu()">
            <i class="bi bi-star-fill"></i> Agregar a Lista
          </button>

          <!-- Menú desplegable de listas -->
          <div *ngIf="showListMenu" class="menu-listas mt-3 p-3 bg-dark rounded shadow-lg">
            <h5 class="text-light mb-2">Selecciona una lista:</h5>
            <ul class="list-unstyled">
              <li *ngFor="let lista of listasUsuario" class="mb-2">
                <button class="btn btn-outline-light w-100 text-start" (click)="agregarSerieALista(lista._id)">
                  {{ lista.nombre }}
                </button>
              </li>
            </ul>
            <button class="btn btn-sm btn-secondary mt-2" (click)="showListMenu = false">Cancelar</button>
          </div>
        </div>

        <p *ngIf="!auth.hasValidSession()" class="text-light mt-3">
          Inicia sesión para interactuar con tus favoritos y listas.
        </p>
      </div>
    </div>
  </main>

</app-layout>